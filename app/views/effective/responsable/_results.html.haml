- # The individiaual responses for one responsable resource
- include_scores = (local_assigns[:include_scores] == true)

.responsable-results
  %table.table.table-hover
    %thead
      %tr
        %th Question
        %th Response
        - if include_scores
          %th Scored Result

    %tbody
      - questionable.questions.top_level.deep.each do |question|
        - response = responsable.response(question: question)

        %tr
          %td= question
          %td= render('effective/responses/response', response: response)

          - if include_scores
            %td
              - if question.scored?
                %span{title: "Correct answer was #{question.answer_to_s}"}
                  - if response.correct? 
                    = badge('Correct', 'badge-success') 
                  - else 
                    = badge('Incorrect', 'badge-danger')
              - else
                = '-'

        - question.follow_up_questions.deep.each do |follow_up_question|
          - response = responsable.response(question: follow_up_question)

          - if response.persisted?
            %tr
              %td= follow_up_question
              %td= render('effective/responses/response', response: response)

              - if include_scores
                %td
                  - if follow_up_question.scored?
                    %span{title: "Correct answer was #{follow_up_question.answer_to_s}"}
                      - if response.correct? 
                        = badge('Correct', 'badge-success') 
                      - else 
                        = badge('Incorrect', 'badge-danger')
                  - else
                    = '-'
